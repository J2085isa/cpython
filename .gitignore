#####
# First, rules intended to apply in all subdirectories.
# These contain no slash, or only a trailing slash.

*.cover
*.iml
*.o
*.lto
*.a
*.so
*.so.*
*.dylib
*.dSYM
*.dll
*.wasm
*.orig
*.pyc
*.pyd
*.pyo
*.rej
*.swp
*~
*.gc??
*.profclang?
*.profraw
# Copies of binaries before BOLT optimizations.
*.prebolt
# BOLT profile data.
*.fdata
*.dyn
.gdb_history
.purify
__pycache__
.hg/
.svn/
.idea/
tags
TAGS
.vs/
.vscode/
gmon.out
.coverage
.mypy_cache/
.pytest_cache/
.ruff_cache/
.DS_Store

*.exe

# Ignore core dumps... but not Tools/msi/core/ or the like.
core
!core/


#####
# Then, rules meant for a specific location relative to the repo root.
# These must contain a non-trailing slash (and may also have a trailing slash.)

Doc/build/
Doc/venv/
Doc/.venv/
Doc/env/
Doc/.env/
Include/pydtrace_probes.h
Lib/site-packages/*
!Lib/site-packages/README.txt
Lib/test/data/*
!Lib/test/data/README
/_bootstrap_python
/Makefile
/Makefile.pre
/iOSTestbed.*
iOS/Frameworks/
iOS/Resources/Info.plist
iOS/testbed/build
iOS/testbed/Python.xcframework/ios-*/bin
iOS/testbed/Python.xcframework/ios-*/include
iOS/testbed/Python.xcframework/ios-*/lib
iOS/testbed/Python.xcframework/ios-*/Python.framework
iOS/testbed/iOSTestbed.xcodeproj/project.xcworkspace
iOS/testbed/iOSTestbed.xcodeproj/xcuserdata
iOS/testbed/iOSTestbed.xcodeproj/xcshareddata
Mac/Makefile
Mac/PythonLauncher/Info.plist
Mac/PythonLauncher/Makefile
Mac/PythonLauncher/Python Launcher
Mac/PythonLauncher/Python Launcher.app/*
Mac/Resources/app/Info.plist
Mac/Resources/framework/Info.plist
Mac/pythonw
/*.framework/
Misc/python.pc
Misc/python-embed.pc
Misc/python-config.sh
Modules/Setup.bootstrap
Modules/Setup.config
Modules/Setup.local
Modules/Setup.stdlib
Modules/config.c
Modules/ld_so_aix
Programs/_freeze_module
Programs/_testembed
PC/python_nt*.h
PC/pythonnt_rc*.h
Modules/python.exp
PC/*/*.exp
PC/*/*.lib
PC/*/*.bsc
PC/*/*.dll
PC/*/*.pdb
PC/*/*.user
PC/*/*.ncb
PC/*/*.suo
PC/*/Win32-temp-*
PC/*/x64-temp-*
PC/*/amd64
PCbuild/*.user
PCbuild/*.suo
PCbuild/*.*sdf
PCbuild/*-pgi
PCbuild/*-pgo
PCbuild/*.VC.db
PCbuild/*.VC.opendb
PCbuild/amd64/
PCbuild/arm32/
PCbuild/arm64/
PCbuild/obj/
PCbuild/win32/
Tools/unicode/data/
/autom4te.cache
/build/
/builddir/
/config.cache
/config.log
/config.status
/config.status.lineno
# hendrikmuhs/ccache-action@v1
/.ccache
/cross-build/
/jit_stencils.h
/platform
/profile-clean-stamp
/profile-run-stamp
/profile-bolt-stamp
/pybuilddir.txt
/pyconfig.h
/python-config
/python-config.py
/python.bat
/python-gdb.py
/python.exe-gdb.py
/reflog.txt
/coverage/
/externals/
/htmlcov/
Tools/msi/obj
Tools/ssl/amd64
Tools/ssl/win32
Tools/freeze/test/outdir

# The frozen modules are always generated by the build so we don't
# keep them in the repo.  Also see Tools/build/freeze_modules.py.
Python/frozen_modules/*.h
# The manifest can be generated at any time with "make regen-frozen".
Python/frozen_modules/MANIFEST

# Two-trick pony for OSX and other case insensitive file systems:
# Ignore ./python binary on Unix but still look into ./Python/ directory.
/python
!/Python/

# main branch only: ABI files are not checked/maintained.
Doc/data/python*.abi
# -*- coding: utf-8 -*-
"""
PROYECTO INTEGRAL: GESTIÃ“N Y OPTIMIZACIÃ“N DE REDES SOCIALES "J/AA" Y "alvareztrucking1"
DescripciÃ³n: Script Ãºnico que integra anÃ¡lisis de perfiles, generaciÃ³n de publicaciones
             y gestiÃ³n de datos para Kwai, Instagram, TikTok y Facebook - incluye perfiles
             personales y empresariales (alvareztrucking1).
Autor: [Tu nombre]
Fecha: 2026-01-07
VersiÃ³n: 1.1
"""

import json
from datetime import datetime
from typing import Dict, Optional


# -------------------------- CLASE: ANALIZADOR DE PERFILES --------------------------
class AnalizadorRedesSociales:
    """Clase para analizar y almacenar datos de perfiles y equipos de redes sociales"""
    
    def __init__(self, nombre_principal: str, id_equipo: Optional[int] = None, es_empresarial: bool = False):
        self.nombre_principal = nombre_principal
        self.id_equipo = id_equipo
        self.es_empresarial = es_empresarial
        self.datos_perfiles: Dict[str, Dict] = {}
        self.datos_equipo: Dict = {}
        self.datos_empresa: Dict = {}

    def cargar_datos_perfil(self, plataforma: str, seguidores: int, siguiendo: int, me_gusta: int, descripcion: str):
        """Carga informaciÃ³n detallada de un perfil por plataforma"""
        self.datos_perfiles[plataforma.lower()] = {
            "nombre_usuario": self.nombre_principal if (plataforma.lower() == "kwai" and not self.es_empresarial) else f"@{self.nombre_principal.lower()}",
            "seguidores": seguidores,
            "siguiendo": siguiendo,
            "me_gusta_totales": me_gusta,
            "descripcion": descripcion,
            "fecha_analisis": datetime.now().strftime("%Y-%m-%d %H:%M"),
            "hashtags_destacados": self._obtener_hashtags(plataforma)
        }

    def cargar_datos_equipo(self, nombre_equipo: str, miembros_actuales: int, max_miembros: int, clasificacion: str):
        """Carga informaciÃ³n del equipo asociado a los perfiles"""
        if self.id_equipo and not self.es_empresarial:
            self.datos_equipo = {
                "id_equipo": self.id_equipo,
                "nombre_equipo": nombre_equipo,
                "miembros_actuales": miembros_actuales,
                "miembros_max": max_miembros,
                "clasificacion": clasificacion,
                "descripcion": "Espacio para compartir momentos diarios y desahogarse de frustraciones cotidianas"
            }

    def cargar_datos_empresa(self, rubro: str, direccion: str, servicio: str, contacto: str):
        """Carga informaciÃ³n de la empresa (para perfiles empresariales como alvareztrucking1)"""
        if self.es_empresarial:
            self.datos_empresa = {
                "rubro": rubro,
                "direccion": direccion,
                "servicios_ofrecidos": servicio,
                "contacto_principal": contacto,
                "horario_atencion": "Lunes a Viernes: 08:00 - 18:00 | SÃ¡bados: 09:00 - 14:00"
            }

    def _obtener_hashtags(self, plataforma: str) -> list:
        """Devuelve hashtags personalizados por plataforma y tipo de perfil"""
        if self.es_empresarial:
            hashtags_base = ["#AlvarezTrucking1", "#Transporte", "#Logistica"]
            plataforma_hashtags = {
                "kwai": ["#KwaiEmpresarial", "#TransporteMexicano"],
                "instagram": ["#InstagramEmpresarial", "#LogisticaCoahuila"],
                "tiktok": ["#TikTokNegocios", "#Camiones"],
                "facebook": ["#FacebookEmpresarial", "#Saltillo"]
            }
        else:
            hashtags_base = ["#DiarioDeVivir", "#JA_AA"]
            plataforma_hashtags = {
                "kwai": ["#Kwai", "#VidaCotidiana"],
                "instagram": ["#Instagram", "#BlogPersonal"],
                "tiktok": ["#TikTok", "#Cotidiano"],
                "facebook": ["#Facebook", "#ComunidadJA_AA"]
            }
        return hashtags_base + plataforma_hashtags.get(plataforma.lower(), [])

    def generar_resumen_completo(self) -> str:
        """Genera y guarda un resumen en texto y JSON con todos los datos"""
        # Crear resumen en texto
        tipo_perfil = "EMPRESARIAL" if self.es_empresarial else "PERSONAL"
        resumen_texto = f"=== RESUMEN COMPLETO DE REDES SOCIALES: {self.nombre_principal} ({tipo_perfil}) ===\n"
        resumen_texto += f"Fecha de anÃ¡lisis: {datetime.now().strftime('%Y-%m-%d %H:%M')}\n\n"

        # Agregar datos de empresa o equipo
        if self.es_empresarial and self.datos_empresa:
            resumen_texto += "--- DATOS DE LA EMPRESA ---\n"
            resumen_texto += f"Rubro: {self.datos_empresa['rubro']}\n"
            resumen_texto += f"DirecciÃ³n: {self.datos_empresa['direccion']}\n"
            resumen_texto += f"Servicios: {self.datos_empresa['servicios_ofrecidos']}\n"
            resumen_texto += f"Contacto: {self.datos_empresa['contacto_principal']}\n"
            resumen_texto += f"Horario: {self.datos_empresa['horario_atencion']}\n\n"
        elif self.datos_equipo:
            resumen_texto += "--- DATOS DEL EQUIPO ---\n"
            resumen_texto += f"ID: {self.datos_equipo['id_equipo']}\n"
            resumen_texto += f"Nombre: {self.datos_equipo['nombre_equipo']}\n"
            resumen_texto += f"Miembros: {self.datos_equipo['miembros_actuales']}/{self.datos_equipo['miembros_max']}\n"
            resumen_texto += f"ClasificaciÃ³n: {self.datos_equipo['clasificacion']}\n\n"

        # Agregar datos de cada perfil
        resumen_texto += "--- DATOS DE PERFILES POR PLATAFORMA ---\n"
        for plataforma, datos in self.datos_perfiles.items():
            resumen_texto += f"\n> PLATAFORMA: {plataforma.upper()}\n"
            resumen_texto += f"  Usuario: {datos['nombre_usuario']}\n"
            resumen_texto += f"  Seguidores: {datos['seguidores']}\n"
            resumen_texto += f"  Siguiendo: {datos['siguiendo']}\n"
            resumen_texto += f"  Me gusta totales: {datos['me_gusta_totales']}\n"
            resumen_texto += f"  DescripciÃ³n: {datos['descripcion']}\n"
            resumen_texto += f"  Hashtags destacados: {' '.join(datos['hashtags_destacados'])}\n"

        # Crear resumen en JSON
        resumen_json = json.dumps({
            "informacion_general": {
                "nombre_principal": self.nombre_principal,
                "tipo_perfil": tipo_perfil,
                "fecha_analisis": datetime.now().strftime("%Y-%m-%d %H:%M")
            },
            "datos_especificos": self.datos_empresa if self.es_empresarial else self.datos_equipo,
            "perfiles": self.datos_perfiles
        }, indent=2, ensure_ascii=False)

        # Guardar archivos
        nombre_archivo = f"resumen_redes_{self.nombre_principal.lower()}"
        with open(f"{nombre_archivo}.txt", "w", encoding="utf-8") as f_txt:
            f_txt.write(resumen_texto)
        
        with open(f"{nombre_archivo}.json", "w", encoding="utf-8") as f_json:
            f_json.write(resumen_json)

        return resumen_texto


# -------------------------- CLASE: GENERADOR DE PUBLICACIONES --------------------------
class GeneradorPublicaciones:
    """Clase para crear plantillas de publicaciones adaptadas a cada plataforma y tipo de perfil"""
    
    def __init__(self, es_empresarial: bool = False):
        self.es_empresarial = es_empresarial
        self.plantillas_personales: Dict[str, Dict] = {
            "kwai": {
                "diario": "ğŸ“… Hoy he vivido esto: {contenido}\n{hashtags}",
                "equipo": "ğŸ¤ Nuestro equipo {nombre_equipo} sigue creciendo! ğŸš€\nÃšnete a nosotros a travÃ©s del ID {id_equipo}\n{hashtags}",
                "reflexion": "ğŸ¤” Aprendizaje del dÃ­a: {contenido}\n{hashtags}"
            },
            "instagram": {
                "foto": "âœ¨ {descripcion}\n\n{hashtags}\n\nSÃ­guenos en Kwai: @{usuario_kwai}",
                "historia": "AquÃ­ va lo Ãºltimo! ğŸ“¸\n{contenido}\n{hashtags}",
                "reel": "Â¿QuÃ© opinas de este momento? ğŸ¬\n{contenido}\n{hashtags}"
            },
            "tiktok": {
                "video": "Â¿Te ha pasado esto? ğŸ¤”\n{contenido}\n{hashtags}",
                "dueto": "Hice un dueto con @{usuario} ğŸ¤\n{contenido}\n{hashtags}",
                "trend": "UnÃ­Ã©ndome a la tendencia! ğŸµ\n{contenido}\n{hashtags}"
            },
            "facebook": {
                "publicacion": "ğŸ“ {contenido}\n\nComparte tu experiencia en los comentarios! ğŸ’¬\n{hashtags}",
                "evento": "ğŸ“… Â¡Nuevo encuentro de la comunidad {nombre_equipo}!\nFecha: {fecha}\nLugar: En lÃ­nea / {lugar}\n{hashtags}",
                "album": "âœ¨ Ãlbum de momentos destacados ğŸ“¸\n{descripcion}\n{hashtags}"
            }
        }

        self.plantillas_empresariales: Dict[str, Dict] = {
            "kwai": {
                "servicio": "ğŸ“¦ Ofrecemos {servicio} con la mejor calidad en {ubicacion}!\nContÃ¡ctanos: {contacto}\n{hashtags}",
                "novedad": "ğŸšš Â¡Nueva unidad en nuestra flota! ğŸ‰\nAhora contamos con mÃ¡s capacidad para tu mercancÃ­a\n{hashtags}",
                "testimonio": "ğŸ™Œ OpiniÃ³n de nuestro cliente {cliente}: {comentario}\nGracias por confiar en nosotros!\n{hashtags}"
            },
            "instagram": {
                "foto_flota": "ğŸ“¸ Conoce nuestra flota de camiones listos para trasladar tu mercancÃ­a\n{descripcion}\n{hashtags}\n\nğŸ“ Contacto: {contacto}",
                "historia_oferta": "Â¡Oferta especial esta semana! ğŸ“¢\nDescuento en envÃ­os a {destino}\n{hashtags}",
                "reel_servicio": "Â¿CÃ³mo gestionamos tus envÃ­os? ğŸ¬\nMira nuestro proceso completo\n{hashtags}"
            },
            "tiktok": {
                "video_flota": "Conoce nuestras unidades ğŸššğŸ’¨\n{contenido}\n{hashtags}",
                "video_tutorial": "Â¿CÃ³mo preparar tu mercancÃ­a para el transporte? ğŸ“¦\n{contenido}\n{hashtags}",
                "video_evento": "Â¡Estuvimos en {evento}! ğŸ¤\nConociendo nuevos clientes y aliados\n{hashtags}"
            },
            "facebook": {
                "publicacion_servicio": "âœ… {servicio} confiable y seguro en Coahuila y zonas aledaÃ±as\n{descripcion}\nContÃ¡ctanos para cotizar: {contacto}\n{hashtags}",
                "evento_empresa": "ğŸ“… Â¡Participamos en la Feria de LogÃ­stica de Saltillo!\nFecha: {fecha}\nVisÃ­tanos en nuestro stand {stand}\n{hashtags}",
                "aviso_importante": "âš ï¸ Aviso importante sobre nuestros horarios en {periodo}\n{informacion}\n{hashtags}"
            }
        }

    def crear_publicacion(self, plataforma: str, tipo: str, **kwargs) -> str:
        """Genera una publicaciÃ³n usando la plantilla correspondiente"""
        plataforma = plataforma.lower()
        plantillas = self.plantillas_empresariales if self.es_empresarial else self.plantillas_personales

        if plataforma not in plantillas:
            return "[ERROR] Plataforma no soportada (opciones: Kwai, Instagram, TikTok, Facebook)"
        
        if tipo not in plantillas[plataforma]:
            return f"[ERROR] Tipo de publicaciÃ³n no disponible para {plataforma} (opciones: {', '.join(plantillas[plataforma].keys())})"
        
        # Agregar hashtags si no se proporcionan
        if "hashtags" not in kwargs:
            if self.es_empresarial:
                kwargs["hashtags"] = " ".join(["#AlvarezTrucking1", "#Transporte", "#Logistica", f"#{plataforma.capitalize()}"])
            else:
                kwargs["hashtags"] = " ".join(["#DiarioDeVivir", "#JA_AA", f"#{plataforma.capitalize()}"])
        
        return plantillas[plataforma][tipo].format(**kwargs)


# -------------------------- CLASE: DEFINICION DE PERFILES --------------------------
class DefinidorPerfiles:
    """Clase que contiene la estructura completa de cada perfil de red social"""
    
    @staticmethod
    def obtener_estructura_perfiles(nombre_principal: str, id_equipo: Optional[int] = None, es_empresarial: bool = False) -> Dict[str, Dict]:
        """Devuelve la configuraciÃ³n detallada de cada perfil"""
        if es_empresarial:
            return {
                "kwai": {
                    "nombre_usuario": f"@{nombre_principal.lower()}",
                    "categoria": "Transporte y logÃ­stica",
                    "descripcion": f"{nombre_principal} - Servicios de transporte terrestre y logÃ­stica integral en Saltillo, Coahuila ğŸšš | EnvÃ­os seguros y puntuales | ContÃ¡ctanos: +52 (844) XXX-XXXX",
                    "enlace_externo": "https://alvareztrucking1.com.mx"
                },
                "instagram": {
                    "nombre_usuario": f"@{nombre_principal.lower()}",
                    "nombre_completo": f"{nombre_principal} - Transporte y LogÃ­stica",
                    "biografia": f"ğŸšš Servicios de transporte terrestre y logÃ­stica en Saltillo y toda MÃ©xico\nâœ… Seguridad | Puntualidad | Precios competitivos\nğŸ“ Contacto: +52 (844) XXX-XXXX\nğŸŒ Sitio web: https://alvareztrucking1.com.mx\n#AlvarezTrucking1 #Transporte #Logistica",
                    "historias_destacadas": ["ğŸ“¦ Servicios", "ğŸšš Flota", "ğŸ™Œ Clientes", "ğŸ“… Eventos"],
                    "enlace_externo": "https://alvareztrucking1.com.mx"
                },
                "tiktok": {
                    "nombre_usuario": f"@{nombre_principal.lower()}",
                    "descripcion": f"{nombre_principal} - Transporte y logÃ­stica en Coahuila ğŸšš | Conoce nuestra flota, servicios y consejos de logÃ­stica | ContÃ¡ctanos para cotizaciones!",
                    "categoria": "Negocios y empresas",
                    "enlace_externo": "https://alvareztrucking1.com.mx"
                },
                "facebook": {
                    "nombre_pagina": f"{nombre_principal} - Transporte y LogÃ­stica",
                    "tipo_pagina": "Empresa de transporte / LogÃ­stica",
                    "descripcion": f"{nombre_principal} ofrece servicios de transporte terrestre y logÃ­stica integral en Saltillo, Coahuila y zonas aledaÃ±as. Contamos con una flota moderna y personal capacitado para garantizar la seguridad y puntualidad de tus envÃ­os ğŸšš\nğŸ“ Contacto: +52 (844) XXX-XXXX\nğŸŒ Sitio web: https://alvareztrucking1.com.mx\nğŸ“§ Correo: contacto@alvareztr
